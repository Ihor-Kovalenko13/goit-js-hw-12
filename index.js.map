{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios, { Axios } from 'axios';\n\nconst API_KEY = '52353296-7e1352dd89e2156c2e1f9fbb2';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function getImagesByQuery(query, page) {\n  const { data } = await axios(BASE_URL, {\n    params: {\n      key: API_KEY,\n      q: query,\n      page,\n      per_page: 15,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n    },\n  });\n  return data;\n}","import SimpleLightbox from 'simplelightbox';\n\nexport const loadBtn = document.querySelector('.load');\nconst loader = document.querySelector('.loader');\nexport const container = document.querySelector('.gallery');\n\nexport const galleryView = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionsDelay: 250,\n  captionPosition: 'bottom',\n});\n\n//  Markup function\n\nexport function createGallery(images) {\n  const markUp = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes = 0,\n        views = 0,\n        comments = 0,\n        downloads = 0,\n      }) => `<li class=\"gallery-item\">\n  <a href=\"${largeImageURL}\" class=\"link\" target=\"_blank\">\n  <img src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" /></a>\n  <ul class=\"description-list\">\n    \n  <li class=\"description-item\">\n      <h3 class=\"description-title\">Likes</h3>\n        <p class=\"description-text\">${likes}</p>\n    </li>\n    \n  <li class=\"description-item\">\n    <h3 class=\"description-title\">Views</h3>\n      <p class=\"description-text\">${views}</p>\n  </li>\n  <li class=\"description-item\">\n    <h3 class=\"description-title\">Comments</h3>\n      <p class=\"description-text\">${comments}</p>\n  </li>\n  <li class=\"description-item\">\n    <h3 class=\"description-title\">Downloads</h3>\n      <p class=\"description-text\">${downloads}</p>\n  </li>\n</ul>\n</li>`\n    )\n    .join('');\n\n  container.insertAdjacentHTML('beforeend', markUp);\n  galleryView.refresh();\n}\n\nexport function clearGallery() {\n  container.innerHTML = '';\n}\n\n// -- Loader control\n\nexport function showLoader() {\n  if (!loader.classList.contains('visible')) {\n    loader.classList.add('visible');\n  }\n}\n\nexport function hideLoader() {\n  if (loader.classList.contains('visible')) {\n    loader.classList.remove('visible');\n  }\n}\n\n//  -- load more button control --\n\nexport function showLoadMoreButton() {\n  if (!loadBtn.classList.contains('visible')) {\n    loadBtn.classList.add('visible');\n  }\n}\n\nexport function hideLoadMoreButton() {\n  if (loadBtn.classList.contains('visible')) {\n    loadBtn.classList.remove('visible');\n  }\n}\n\nexport function disableButton() {\n  loadBtn.setAttribute('disabled', 'true');\n}\n\nexport function enableButton() {\n  loadBtn.removeAttribute('disabled');\n}\n\n// -- interaction with local storage --\n\nexport function saveQuery(query) {\n  localStorage.setItem('queryWord', query);\n}\n\nexport function getQuery() {\n  return localStorage.getItem('queryWord');\n}\n\nexport function removeQueryLocal() {\n  localStorage.removeItem('queryWord');\n}\n\n//-- text fo iziToast--\n\nexport function errorText(error) {\n  const errorText = {\n    title: 'Error',\n    message: `Oops.. something goes wrong, error : ${error.status} !`,\n    position: 'center',\n    timeout: 5000,\n    progressBar: false,\n    close: false,\n    icon: '',\n    messageColor: 'white',\n    titleColor: 'white',\n  };\n  return errorText;\n}\n\nexport function infoText() {\n  const infoText = {\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    position: 'center',\n    timeout: 5000,\n    progressBar: false,\n    close: false,\n    icon: '',\n    messageColor: 'white',\n  };\n  return infoText;\n}\n\nexport function fillText() {\n  const fillText = {\n    message: 'Sorry, you need to fill sear—Åh query',\n    position: 'topRight',\n    timeout: 5000,\n    progressBar: false,\n    close: false,\n    icon: '',\n    messageColor: 'white',\n  };\n  return fillText;\n}\n\nexport function endText() {\n  const endText = {\n    message: `We're sorry, but you've reached the end of search results.`,\n    position: 'center',\n    timeout: 5000,\n    progressBar: false,\n    close: false,\n    icon: '',\n    messageColor: 'white',\n  };\n  return endText;\n}\n\n// --- scroll function----\n\nexport function scrollPage() {\n  const card = document.querySelector('.gallery-item');\n  if (!card) return;\n\n  const cardHeight = card.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}","import iziToast from 'izitoast';\nimport { getImagesByQuery } from './js/pixabay-api';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  loadBtn,\n  disableButton,\n  enableButton,\n  saveQuery,\n  getQuery,\n  removeQueryLocal,\n  endText,\n  infoText,\n  fillText,\n  errorText,\n  scrollPage,\n} from './js/render-functions';\n\nconst form = document.querySelector('.form');\n\nlet page = 1;\nlet totalPage = 1;\n\nform.addEventListener('submit', showGallery);\nloadBtn.addEventListener('click', clickLoad);\n\nasync function showGallery(event) {\n  event.preventDefault();\n  clearGallery();\n  page = 1;\n\n  const query = event.target.elements['search-text'].value.trim();\n  if (!query) {\n    iziToast.error(fillText());\n    return;\n  }\n\n  try {\n    showLoader();\n\n    const { hits, totalHits } = await getImagesByQuery(query, page);\n\n    if (!hits.length) {\n      iziToast.info(infoText());\n      return;\n    }\n\n    createGallery(hits);\n    // scrollPage();\n\n    totalPage = Math.ceil(totalHits / 15);\n\n    if (page < totalPage) {\n      saveQuery(query);\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n      form.reset();\n    }\n  } catch (error) {\n    iziToast.error(errorText(error));\n  } finally {\n    hideLoader();\n    // form.reset();\n  }\n}\n\nasync function clickLoad(event) {\n  page += 1;\n  const query = getQuery();\n\n  try {\n    showLoader();\n    disableButton();\n    const { hits } = await getImagesByQuery(query, page);\n    createGallery(hits);\n\n    scrollPage();\n    if (page >= totalPage) {\n      hideLoadMoreButton();\n      removeQueryLocal();\n      iziToast.error(endText());\n      form.reset();\n    }\n  } catch (error) {\n    iziToast.error(errorText(error));\n  } finally {\n    hideLoader();\n    enableButton();\n  }\n}"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","data","axios","loadBtn","loader","container","galleryView","SimpleLightbox","createGallery","images","markUp","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","disableButton","enableButton","saveQuery","getQuery","removeQueryLocal","errorText","error","infoText","fillText","endText","scrollPage","card","cardHeight","form","totalPage","showGallery","clickLoad","event","iziToast","hits","totalHits"],"mappings":"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"}